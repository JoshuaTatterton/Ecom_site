<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container-fluid">
    <% if current_user %>
      <div class="navbar-brand">
        <% if Switch.current_account && current_user.accounts.count > 1 %>
          <ul class="navbar-nav my-2 my-lg-0">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="account_nav" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <%= Switch.this_account.name %>
              </a>
              <ul class="dropdown-menu">
                <% current_user.accounts.select { |a| a.reference != Switch.current_account }.each_with_index do |account, index| %>
                  <li>
                    <%= link_to account.name, admin_path(account.reference), class: "dropdown-item" %>
                  </li>
                  <% if index < current_user.accounts.count - 2 %>
                    <li><hr class="dropdown-divider"></li>
                  <% end %>
                <% end %>
              </ul>
            </li>
          </ul>
        <% elsif Switch.current_account %>
          <%= link_to Switch.this_account.name, admin_path(Switch.current_account), class: "dropdown-item" %>
        <% end %>
      </div>

      <div class="d-flex">
        <ul class="navbar-nav me-auto my-2 my-lg-0" style="--bs-scroll-height: 100px;">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="user_nav" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <%= current_user.email %>
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Edit</a></li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <%= link_to "Sign out", admin_sign_out_path, data: { turbo_method: :delete }, class: "dropdown-item" %>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    <% else %>
      <div class="navbar-brand">
        <%= image_tag("bootstrap/sign-stop.svg", class: "bi bi-sign-stop") %>
      </div>
    <% end %>
  </div>
</nav>
